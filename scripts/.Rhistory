guides(fill = guide_legend(nrow = 4, byrow = TRUE))
ggsave('../images/Clusters.png')
rm(cybu_p, k)
ggmap::ggmap(hb) +
coord_sf(xlim = c(bbox[1], bbox[3]), ylim = c(bbox[2], bbox[4]), crs = 4326) +
geom_sf(data = k, aes(fill = factor(Cluster)), inherit.aes = FALSE) +
scale_fill_manual(name = 'Geographic Cluster', values = as.vector(brewer.paired(26))) +
theme_void() +
labs(
title = 'Naive Geographic Clusters',
subtitle = 'Cymopterus bulbosus') +
theme(
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5, face = "italic"),
legend.title = element_text(hjust = 0.5),
legend.title.position = "top",
legend.position = 'bottom'
) +
guides(fill = guide_legend(nrow = 2, byrow = TRUE))
cybu_p <- terra::as.polygons(cybu, values = FALSE, na.rm = TRUE) |>
sf::st_as_sf()
cybu_p <- terra::as.polygons(cybu, values = FALSE, na.rm = TRUE) |>
sf::st_as_sf()
k <- EqualAreaPolygons(cybu_p)
k <- EqualAreaPolygons(cybu_p)
k <- st_as_sf(k)
k <- st_as_sf(k)
ggmap::ggmap(hb) +
coord_sf(xlim = c(bbox[1], bbox[3]), ylim = c(bbox[2], bbox[4]), crs = 4326) +
geom_sf(data = k, aes(fill = factor(Cluster)), inherit.aes = FALSE) +
scale_fill_manual(name = 'Geographic Cluster', values = as.vector(brewer.paired(26))) +
theme_void() +
labs(
title = 'Naive Geographic Clusters',
subtitle = 'Cymopterus bulbosus') +
theme(
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5, face = "italic"),
legend.title = element_text(hjust = 0.5),
legend.title.position = "top",
legend.position = 'bottom'
) +
guides(fill = guide_legend(nrow = 2, byrow = TRUE))
ggsave('../images/Clusters.png' )
## create a first site with 4 species
species %>%
filter(!taxon %in% c('Qualitus latus', 'Regularis sparsum', 'Glomeratus sparsum')) %>%
ggplot() +
geom_jitter(aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
scale_fill_manual(values = brewer.pal(n = 8, 'Set1'), drop = FALSE) +
scale_color_manual(values = brewer.pal(n = 8, 'Set1'), drop = FALSE) +
# use color brewer
scale_shape_manual(values = c(7:9, 21:26), drop = FALSE) +
theme_minimal() +
labs(x = NULL, y = NULL, title = 'Site A', subtitle = 'alpha = 9') +
theme(
plot.title = element_text(hjust = 0.5)
)
library(tidyverse)
library(sf)
library(patchwork)
library(RColorBrewer)
setwd('~/Documents/assoRted/CLM_2024_Veg_Ecology/scripts')
## very clumped
very_clumped <- data.frame(
x = rnorm(n = 10, mean = 15, sd = 5),
y = rnorm(n = 10, mean = 25, sd = 5),
taxon = 'Glomeratus ipsum'
)
# sparsely clumped
sparsely_clumped <- data.frame(
x = rnorm(n = 10, mean = 75, sd = 10),
y = rnorm(n = 10, mean = 85, sd = 5),
taxon = 'Glomeratus sparsum'
)
# several clumps
several_clumps <- data.frame(
x = c(
rnorm(n = 10, mean = 20, sd = 15),
rnorm(n = 5, mean = 40, sd = 5),
rnorm(n = 10, mean = 80, sd = 5)
),
y = c(
rnorm(n = 10, mean = 85, sd = 5),
rnorm(n = 5, mean = 40, sd = 5),
rnorm(n = 10, mean = 20, sd = 5)
),
taxon = 'Glomeratus multi'
)
############# regularly dispersed plant species #########################
######### abundant #########3
reg_abundant <- expand.grid(
x = seq(from = 1, to = 100, by = 12),
y = seq(from = 1, to = 100, by = 12),
taxon = 'Regularis abundat'
)
reg_abundant[,1:2] <- apply(reg_abundant[,1:2], MARGIN = 2, FUN = jitter, amount = 2)
##### not abundant  #########3
reg_not_ab <- expand.grid(
x = seq(from = 5, to = 100, by = 27),
y = seq(from = 5, to = 100, by = 27),
taxon = 'Regularis sparsum'
)
reg_not_ab[,1:2] <- apply(reg_not_ab[,1:2], MARGIN = 2, FUN = jitter, amount = 5)
### species restricted to remnant habitat in the center of the site
interior <- data.frame(
x = rnorm(n = 10, mean = 50, sd = 15),
y = rnorm(n = 10, mean = 50, sd = 15),
taxon = 'Qualitas interior'
)
### randomly distributed
random <- data.frame(
round(randu[sample(1:400, size = 15),1:2] * 100),
taxon = 'Qualitas rarus'
)
edge <- data.frame(
x = ceiling(dpois(5:30, lambda = 10)  * 100),
y = sample(1:100, size = 26),
taxon = 'Qualitus latus'
)
plot(x = edge$x, y = edge$y, xlim = c(0, 100))
# put them together
species <- rbind(reg_abundant, reg_not_ab, several_clumps, sparsely_clumped,
very_clumped, interior, random, edge)
rm(reg_abundant, reg_not_ab, several_clumps, sparsely_clumped,
very_clumped, interior, random, edge)
unique(species$taxon)
## create a first site with 4 species
species %>%
filter(!taxon %in% c('Qualitus latus', 'Regularis sparsum', 'Glomeratus sparsum')) %>%
ggplot() +
geom_jitter(aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
scale_fill_manual(values = brewer.pal(n = 8, 'Set1'), drop = FALSE) +
scale_color_manual(values = brewer.pal(n = 8, 'Set1'), drop = FALSE) +
# use color brewer
scale_shape_manual(values = c(7:9, 21:26), drop = FALSE) +
theme_minimal() +
labs(x = NULL, y = NULL, title = 'Site A', subtitle = 'alpha = 9') +
theme(
plot.title = element_text(hjust = 0.5)
)
unique(species$taxon)
values(unique(species$taxon))
as.character(unique(species$taxon))
c(21:26)
as.character(unique(species$taxon))
c(
21, 21, # for the regulary distributed material
22, 22, 22, 22,
23, 23, 23
)
v <- c(
21, 21, # for the regulary distributed material
22, 22, 22, 22,
23, 23, 23
)
## create a first site with 4 species
species %>%
filter(!taxon %in% c('Qualitus latus', 'Regularis sparsum', 'Glomeratus sparsum')) %>%
ggplot() +
geom_jitter(aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
# we will use shapes to illustrate the three genera.
scale_shape_manual(values = v, drop = FALSE) +
scale_fill_manual(values = brewer.pal(n = 8, 'Set1'), drop = FALSE) +
scale_color_manual(values = brewer.pal(n = 8, 'Set1'), drop = FALSE) +
# use color brewer
theme_minimal() +
labs(x = NULL, y = NULL, title = 'Site A', subtitle = 'alpha = 9') +
theme(
plot.title = element_text(hjust = 0.5)
)
## create a first site with 4 species
species %>%
filter(!taxon %in% c('Qualitus latus', 'Regularis sparsum', 'Glomeratus sparsum')) %>%
ggplot() +
geom_jitter(aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
# we will use shapes to illustrate the three genera.
scale_shape_manual(values = v, drop = FALSE) +
scale_fill_manual(values = brewer.pal(n = 8, 'Set1'), drop = FALSE) +
scale_color_manual(values = brewer.pal(n = 8, 'Set1'), drop = FALSE) +
# use color brewer
theme_minimal() +
labs(x = NULL, y = NULL, title = 'Site A', subtitle = 'alpha = 9') +
theme(
plot.title = element_text(hjust = 0.5)
)
## create a first site with 4 species
species %>%
filter(!taxon %in% c('Qualitus latus', 'Regularis sparsum', 'Glomeratus sparsum')) %>%
ggplot() +
geom_jitter(aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
# we will use shapes to illustrate the three genera.
scale_shape_manual(values = v, drop = FALSE) +
scale_fill_manual(values = brewer.pal(n = 8, 'Set1'), drop = FALSE) +
scale_color_manual(values = brewer.pal(n = 8, 'Set1'), drop = FALSE) +
# use color brewer
theme_minimal() +
labs(x = NULL, y = NULL, title = 'Site A', subtitle = 'alpha = 9') +
theme(
plot.title = element_text(hjust = 0.5)
)
v
as.character(unique(species$taxon))
mycolors = c("a" = "red", "b"="blue", "c"="green", <etc>)
mycolors = c("a" = "red", "b"="blue", "c"="green")
mycolors
setNames(
c(21, 21, 22, 22, 22, 22, 23, 23, 23),
as.character(unique(species$taxon))
)
mycolors
shapes <- setNames(
c(21, 21, 22, 22, 22, 22, 23, 23, 23),
as.character(unique(species$taxon))
)
## create a first site with 4 species
species %>%
filter(!taxon %in% c('Qualitus latus', 'Regularis sparsum', 'Glomeratus sparsum')) %>%
ggplot() +
geom_jitter(aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
# we will use shapes to illustrate the three genera.
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = brewer.pal(n = 8, 'Set1'), drop = FALSE) +
scale_color_manual(values = brewer.pal(n = 8, 'Set1'), drop = FALSE) +
# use color brewer
theme_minimal() +
labs(x = NULL, y = NULL, title = 'Site A', subtitle = 'alpha = 9') +
theme(
plot.title = element_text(hjust = 0.5)
)
shapes <- setNames(
c(21, 21, 22, 22, 22, 22, 23, 23, 23),
as.character(unique(species$taxon))
)
## create a first site with 4 species
species %>%
filter(!taxon %in% c('Qualitus latus', 'Regularis sparsum', 'Glomeratus sparsum')) %>%
ggplot() +
geom_jitter(aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
# we will use shapes to illustrate the three genera.
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = brewer.pal(n = 8, 'Set1'), drop = FALSE) +
scale_color_manual(values = brewer.pal(n = 8, 'Set1'), drop = FALSE) +
# use color brewer
theme_minimal() +
labs(x = NULL, y = NULL, title = 'Site A', subtitle = 'alpha = 9') +
theme(
plot.title = element_text(hjust = 0.5)
)
shapes <- setNames(
c(21, 21, 22, 22, 22, 23, 23, 23),
as.character(unique(species$taxon))
)
## create a first site with 4 species
species %>%
filter(!taxon %in% c('Qualitus latus', 'Regularis sparsum', 'Glomeratus sparsum')) %>%
ggplot() +
geom_jitter(aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
# we will use shapes to illustrate the three genera.
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = brewer.pal(n = 8, 'Set1'), drop = FALSE) +
scale_color_manual(values = brewer.pal(n = 8, 'Set1'), drop = FALSE) +
# use color brewer
theme_minimal() +
labs(x = NULL, y = NULL, title = 'Site A', subtitle = 'alpha = 9') +
theme(
plot.title = element_text(hjust = 0.5)
)
shapes <- setNames(
c(21, 21, 22, 22, 22, 23, 23, 23),
as.character(unique(species$taxon))
)
## create a first site with 4 species
species %>%
filter(!taxon %in% c('Qualitus latus', 'Regularis sparsum', 'Glomeratus sparsum')) %>%
ggplot() +
geom_jitter(aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
# we will use shapes to illustrate the three genera.
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = brewer.pal(n = 8, 'Set1'), drop = FALSE) +
scale_color_manual(values = brewer.pal(n = 8, 'Set1'), drop = FALSE) +
# use color brewer
theme_minimal() +
labs(x = NULL, y = NULL, title = 'Site A', subtitle = 'alpha = 9') +
theme(
plot.title = element_text(hjust = 0.5)
)
brewer.pal(n = 8, 'Set1')
display.brewer.pal(n = 8, 'Set1')
display.brewer.pal(n = 8, 'Set1', names = T)
?display.brewer.pal
display.brewer.pal(n = 8, 'Set1', names = T)
display.brewer.pal(n = 8, 'Set1')
brewer.pal(n = 8, 'Set1')
display.brewer.all(n = 8, 'Set1')
display.brewer.all(n = 8)
brewer.pal(n = 8, 'Dark2')
## create a first site with 4 species
species %>%
filter(!taxon %in% c('Qualitus latus', 'Regularis sparsum', 'Glomeratus sparsum')) %>%
ggplot() +
geom_jitter(aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
# we will use shapes to illustrate the three genera.
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = brewer.pal(n = 8, 'Dark2'), drop = FALSE) +
scale_color_manual(values = brewer.pal(n = 8, 'Dark2'), drop = FALSE) +
# use color brewer
theme_minimal() +
labs(x = NULL, y = NULL, title = 'Site A', subtitle = 'alpha = 9') +
theme(
plot.title = element_text(hjust = 0.5)
)
display.brewer.all(n = 8)
display.brewer.pal(n = 8, 'Dark2')
## create a first site with 4 species
species %>%
filter(!taxon %in% c('Qualitus latus', 'Regularis sparsum', 'Glomeratus sparsum')) %>%
ggplot() +
geom_jitter(aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
# we will use shapes to illustrate the three genera.
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = brewer.pal(n = 8, 'Dark2'), drop = FALSE) +
scale_color_manual(values = brewer.pal(n = 8, 'Dark2'), drop = FALSE) +
# use color brewer
theme_minimal() +
labs(x = NULL, y = NULL, title = 'Site A', subtitle = 'alpha = 9') +
theme(
plot.title = element_text(hjust = 0.5)
)
dark8 <- setNames(
brewer.pal(n = 8, 'Dark2'),
v
)
dark8 <- setNames(
brewer.pal(n = 8, 'Dark2'),
v
)
dark8 <- setNames(
brewer.pal(n = 8, 'Dark2'),
as.character(unique(species$taxon))
)
## create a first site with 4 species
species %>%
filter(!taxon %in% c('Qualitus latus', 'Regularis sparsum', 'Glomeratus sparsum')) %>%
ggplot() +
geom_jitter(aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
# we will use shapes to illustrate the three genera.
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = dark8, drop = FALSE) +
scale_color_manual(values = dark8, drop = FALSE) +
# use color brewer
theme_minimal() +
labs(x = NULL, y = NULL, title = 'Site A', subtitle = 'alpha = 9') +
theme(
plot.title = element_text(hjust = 0.5)
)
## create a first site with 4 species
species %>%
filter(!taxon %in% c('Qualitus latus', 'Regularis sparsum', 'Glomeratus sparsum')) %>%
ggplot() +
geom_jitter(aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
# we will use shapes to illustrate the three genera.
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = dark8, drop = FALSE) +
scale_color_manual(values = dark8, drop = FALSE) +
# use color brewer
theme_minimal() +
labs(x = NULL, y = NULL, title = 'Site A', subtitle = 'alpha = 9') +
theme(
plot.title = element_text(hjust = 0.5)
)
# legend here.
species %>%
ggplot(species, aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2))
# legend here.
species %>%
ggplot(species, aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2)
# legend here.
species %>%
ggplot(species, aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2)
# legend here.
ggplot(species, aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2)
# legend here.
ggplot(species, aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = dark8, drop = FALSE) +
scale_color_manual(values = dark8, drop = FALSE)
# legend here.
ggplot(species, aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = dark8, drop = FALSE) +
scale_color_manual(values = dark8, drop = FALSE)
# legend here.
ggplot(species, aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
geom_jitter() +
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = dark8, drop = FALSE) +
scale_color_manual(values = dark8, drop = FALSE)
# legend here.
ggplot(species, aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
geom_jitter() +
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = dark8, drop = FALSE) +
scale_color_manual(values = dark8, drop = FALSE) +
theme_minimal()
# legend here.
ggplot(species, aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
geom_jitter() +
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = dark8, drop = FALSE) +
scale_color_manual(values = dark8, drop = FALSE) +
theme_minimal() +
labs(x = NULL, y = NULL) +
theme(
plot.title = element_text(hjust = 0.5)
)
cowplot::get_legend(p)
# legend here.
p <- ggplot(species, aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
geom_jitter() +
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = dark8, drop = FALSE) +
scale_color_manual(values = dark8, drop = FALSE) +
theme_minimal() +
labs(x = NULL, y = NULL) +
theme(
plot.title = element_text(hjust = 0.5)
)
cowplot::get_legend(p)
cowplot::get_legend(p, return_all = TRUE)
install.packages('cowplot')
install.packages("cowplot")
install.packages("cowplot")
plot(legend)
legend <- cowplot::get_legend(p)
plot(legend)
# legend here.
p <- ggplot(species, aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
geom_jitter() +
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = dark8, drop = FALSE) +
scale_color_manual(values = dark8, drop = FALSE) +
theme_minimal() +
labs(x = NULL, y = NULL) +
theme(
plot.title = element_text(hjust = 0.5),
legend.title = element_text(hjust = 0.5)
)
library(tidyverse)
library(sf)
library(patchwork)
library(RColorBrewer)
setwd('~/Documents/assoRted/CLM_2024_Veg_Ecology/scripts')
# legend here.
p <- ggplot(species, aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
geom_jitter() +
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = dark8, drop = FALSE) +
scale_color_manual(values = dark8, drop = FALSE) +
theme_minimal() +
labs(x = NULL, y = NULL) +
theme(
plot.title = element_text(hjust = 0.5),
legend.title = element_text(hjust = 0.5)
)
legend <- cowplot::get_legend(p)
plot(legend)
# legend here.
p <- ggplot(species, aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
geom_jitter() +
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = dark8, drop = FALSE) +
scale_color_manual(values = dark8, drop = FALSE) +
theme_minimal() +
labs(x = NULL, y = NULL) +
theme(
plot.title = element_text(hjust = 0.5),
legend.title = element_text(hjust = 0.5),
) +
guides(fill = guide_legend(ncol=3))
legend <- cowplot::get_legend(p)
plot(legend)
# legend here.
p <- ggplot(species, aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
geom_jitter() +
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = dark8, drop = FALSE) +
scale_color_manual(values = dark8, drop = FALSE) +
theme_minimal() +
labs(x = NULL, y = NULL) +
theme(
plot.title = element_text(hjust = 0.5),
legend.title = element_text(hjust = 0.5),
) +
guides(fill = guide_legend(ncol=3))
legend <- cowplot::get_legend(p)
plot(legend)
# legend here.
p <- ggplot(species, aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
geom_jitter() +
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = dark8, drop = FALSE) +
scale_color_manual(values = dark8, drop = FALSE) +
theme_minimal() +
labs(x = NULL, y = NULL) +
theme(
plot.title = element_text(hjust = 0.5),
legend.title = element_text(hjust = 0.5),
) +
guides(fill = guide_legend(ncol = 3))
legend <- cowplot::get_legend(p)
plot(legend)
