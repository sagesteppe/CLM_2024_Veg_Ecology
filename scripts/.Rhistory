as.character(unique(species$taxon))
)
dark8 <- setNames(
brewer.pal(n = 8, 'Dark2'),
as.character(unique(species$taxon))
)
## create a first site with 4 species
# legend here.
p <- ggplot(species, aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
geom_jitter() +
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = dark8, drop = FALSE) +
scale_color_manual(values = dark8, drop = FALSE) +
theme_minimal() +
labs(x = NULL, y = NULL) +
theme(
plot.title = element_text(hjust = 0.5),
legend.title = element_text(hjust = 0.5),
) +
guides(
fill = guide_legend(ncol = 3),
)
legend <- cowplot::get_legend(p)
plot(legend)
unique(as.character(unique(species$taxon)))
site_a <- filter(species,
!taxon %in% c("Qualitas interior",  "Glomeratus sparsum",
"Qualitas rarus", "Regularis sparsum"))
plot_a <- ggplot(site_a) +
geom_jitter(aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = dark8, drop = FALSE) +
scale_color_manual(values = dark8, drop = FALSE) +
theme_minimal() +
labs(
x = NULL,
y = NULL,
title = 'Site A',
subtitle = paste0('\u03b1 = ', length(unique(site_a$taxon)))) +
theme(
plot.title = element_text(hjust = 0.5),
legend.position = 'none'
)
## now create a third site
site_b <- filter(species,
!taxon %in% c('Glomeratus multi', 'Glomeratus ipsum', 'Qualitus latus'))
plot_b <- ggplot(site_b) +
geom_jitter(aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = dark8, drop = FALSE) +
scale_color_manual(values = dark8, drop = FALSE) +
theme_minimal() +
labs(
x = NULL,
y = NULL,
title = 'Site B',
subtitle = paste0('\u03b1 = ', length(unique(site_b$taxon)))) +
theme(
plot.title = element_text(hjust = 0.5),
legend.position = 'none'
)
site_c <- filter(species,
!taxon %in% c('Glomeratus ipsum', 'Regularis sparsum'))
plot_c <- ggplot(site_c) +
geom_jitter(aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = dark8, drop = FALSE) +
scale_color_manual(values = dark8, drop = FALSE) +
theme_minimal() +
labs(
x = NULL,
y = NULL,
title = 'Site B',
subtitle = paste0('\u03b1 = ', length(unique(site_c$taxon))))  +
theme(
plot.title = element_text(hjust = 0.5),
legend.position = 'none'
)
plot_row <- plot_grid(plot_a, plot_b, plot_c, ncol = 3)
spp_by_site <- bind_rows(
cbind(site_a, Site = 'A'), cbind(site_b, Site = 'B'), cbind(site_c, Site = 'C')
) %>%
distinct(Site, taxon)
title <- ggdraw() +  # create a shared title for the plot with three Sites.
draw_label(
paste0(
"\u03b3-Diversity (",
length(unique(spp_by_site$taxon)) ,
") of an area with three major sites"),
fontface = 'bold',
x = 0,
hjust = 0
) +
theme( # add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 7)
)
plot_grid(
title, plot_row,
ncol = 1,
rel_heights = c(0.1, 1)
)
rm(dark8, shapes, plot_a, plot_b, plot_c)
spp_by_site <- bind_rows(
cbind(site_a, Site = 'A'), cbind(site_b, Site = 'B'), cbind(site_c, Site = 'C')
) %>%
distinct(Site, taxon) %>%
mutate(Values = 1) %>%
pivot_wider(names_from = taxon, values_from = Values) %>%
column_to_rownames('Site')
rm(site_a, site_b, site_c, dark8, shapes)
spp_by_site <- apply(spp_by_site, MARGIN = 2, FUN = function(x){ifelse(is.na(x), 0, 1)})
library(vegan)
rm(dark8, shapes)
beta_d_results <- vegan::betadiver(spp_by_site, 'w')
matrix(beta_d_results)
gridExtra::tableGrob(beta_d_results)
matrix(beta_d_results)
str(beta_d_results)
matrix(beta_d_results)
str(beta_d_results)
matrix(beta_d_results)
beta_d_results
beta_d_results
colnames(beta_d_results)
str(beta_d_results)
beta_d_results
data.frame(
row.names = c('B', 'C'),
A = c(0.777, 0.4),
B = c(NA, 0.2727)
)
data.frame(
row.names = c('B', 'C'),
A = c(0.777, 0.4),
B = c('NA', 0.2727)
)
data.frame(
row.names = c('B', 'C'),
A = c(0.777, 0.4),
B = c('', 0.2727)
)
matrix(beta_d_results)
data.frame(
row.names = c('B', 'C'),
A = c(0.777, 0.4),
B = c('', 0.2727)
)
beta_distances <- data.frame(
row.names = c('B', 'C'),
A = c(0.777, 0.4),
B = c('', 0.2727)
)
gridExtra::tableGrob(beta_d_results)
gridExtra::tableGrob(beta_distances)
beta_d_tab <- gridExtra::tableGrob(beta_distances)
plot(beta_d_tab)
beta_distances <- data.frame(
row.names = c('B', 'C'),
A = c(0.777, 0.4),
B = c('', 0.2727)
)
beta_d_tab <- gridExtra::tableGrob(beta_distances)
plot(beta_d_tab)
plot(beta_d_tab)
beta_d_tab <- gridExtra::tableGrob(beta_distances)
beta_d_tab <- gridExtra::tableGrob(beta_distances)
plot(beta_d_tab)
rm(site_a, site_b, site_c, dark8, shapes)
plot_grid(
title, plot_row,
ncol = 1,
rel_heights = c(0.1, 1)
)
plot_grid(plot_row, legend)
plot_grid(plot_row, legend, rel_widths = 1, 0.2)
plot_grid(plot_row, legend, rel_widths = 1, 0.1)
plot_grid(plot_row, legend, rel_widths = 5, 0.1)
plot_grid(plot_row, legend, rel_widths = 1, 0.1)
plot_grid(plot_row, legend, rel_widths = c(1, 0.1))
plot_grid(plot_row, legend, rel_widths = c(1, 0.2))
plot_grid(plot_row, legend, rel_widths = c(1, 0.4))
plot_grid(plot_row, legend, rel_widths = c(1, 0.25))
plot_grid(plot_row, legend, rel_widths = c(1, 0.3))
plot_grid(plot_row, legend, rel_widths = c(1, 0.4))
# legend here.
p <- ggplot(species, aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
geom_jitter() +
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = dark8, drop = FALSE) +
scale_color_manual(values = dark8, drop = FALSE) +
theme_minimal() +
labs(x = NULL, y = NULL) +
theme(
plot.title = element_text(hjust = 0.5),
legend.title = element_text(hjust = 0.5),
legend.position = 'bottom'
) +
guides(
fill = guide_legend(ncol = 3),
)
legend <- cowplot::get_legend(p)
plot(legend)
shapes <- setNames(
c(21, 21, 22, 22, 22, 23, 23, 23),
as.character(unique(species$taxon))
)
dark8 <- setNames(
brewer.pal(n = 8, 'Dark2'),
as.character(unique(species$taxon))
)
# legend here.
p <- ggplot(species, aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
geom_jitter() +
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = dark8, drop = FALSE) +
scale_color_manual(values = dark8, drop = FALSE) +
theme_minimal() +
labs(x = NULL, y = NULL) +
theme(
plot.title = element_text(hjust = 0.5),
legend.title = element_text(hjust = 0.5),
legend.position = 'bottom'
) +
guides(
fill = guide_legend(ncol = 3),
)
legend <- cowplot::get_legend(p)
plot(legend)
# legend here.
p <- ggplot(species, aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
geom_jitter() +
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = dark8, drop = FALSE) +
scale_color_manual(values = dark8, drop = FALSE) +
theme_minimal() +
labs(x = NULL, y = NULL) +
theme(
plot.title = element_text(hjust = 0.5),
legend.title = element_text(hjust = 0.5),
legend.position = 'bottom'
) +
guides(
fill = guide_legend(ncol = 3),
)
legend <- cowplot::get_legend(p)
plot(legend)
# legend here.
p <- ggplot(species, aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
geom_jitter() +
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = dark8, drop = FALSE) +
scale_color_manual(values = dark8, drop = FALSE) +
theme_minimal() +
labs(x = NULL, y = NULL) +
theme(
plot.title = element_text(hjust = 0.5),
legend.title = element_text(hjust = 0.5),
legend.position = 'bottom'
) +
guides(
fill = guide_legend(ncol = 3),
)
# legend here.
p <- ggplot(species, aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
geom_jitter() +
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = dark8, drop = FALSE) +
scale_color_manual(values = dark8, drop = FALSE) +
theme_minimal() +
labs(x = NULL, y = NULL) +
theme(
plot.title = element_text(hjust = 0.5),
legend.title = element_text(hjust = 0.5)#,
#  legend.position = 'bottom'
) +
guides(
fill = guide_legend(ncol = 3),
)
legend <- cowplot::get_legend(p)
plot(legend)
plot(legend)
# legend here.
p <- ggplot(species, aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
geom_jitter() +
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = dark8, drop = FALSE) +
scale_color_manual(values = dark8, drop = FALSE) +
theme_minimal() +
labs(x = NULL, y = NULL) +
theme(
plot.title = element_text(hjust = 0.5),
legend.title = element_text(hjust = 0.5),
legend.position = 'bottom'
) +
guides(
fill = guide_legend(ncol = 3),
)
legend <- cowplot::get_legend(p)
plot(legend)
# legend here.
p <- ggplot(species, aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
geom_jitter() +
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = dark8, drop = FALSE) +
scale_color_manual(values = dark8, drop = FALSE) +
theme_minimal() +
labs(x = NULL, y = NULL) +
theme(
plot.title = element_text(hjust = 0.5),
legend.title = element_text(hjust = 0.5),
legend.position = 'bottom'
) +
guides(
fill = guide_legend(ncol = 3),
)
# legend here.
p <- ggplot(species, aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
geom_jitter() +
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = dark8, drop = FALSE) +
scale_color_manual(values = dark8, drop = FALSE) +
theme_minimal() +
labs(x = NULL, y = NULL) +
theme(
plot.title = element_text(hjust = 0.5),
legend.title = element_text(hjust = 0.5),
legend.position = 'bottom'
)# +
legend <- cowplot::get_legend(p)
plot(legend)
# legend here.
p <- ggplot(species, aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
geom_jitter() +
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = dark8, drop = FALSE) +
scale_color_manual(values = dark8, drop = FALSE) +
theme_minimal() +
labs(x = NULL, y = NULL) +
theme(
plot.title = element_text(hjust = 0.5),
legend.title = element_text(hjust = 0.5)
)# +
# legend here.
p <- ggplot(species, aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
geom_jitter() +
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = dark8, drop = FALSE) +
scale_color_manual(values = dark8, drop = FALSE) +
theme_minimal() +
labs(x = NULL, y = NULL) +
theme(
plot.title = element_text(hjust = 0.5),
legend.title = element_text(hjust = 0.5)
) +
guides(
fill = guide_legend(ncol = 3),
)
legend <- cowplot::get_legend(p)
plot(legend)
# legend here.
p <- ggplot(species, aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
geom_jitter() +
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = dark8, drop = FALSE) +
scale_color_manual(values = dark8, drop = FALSE) +
theme_minimal() +
labs(x = NULL, y = NULL) +
theme(
plot.title = element_text(hjust = 0.5),
legend.title = element_text(hjust = 0.5),
legend.direction ="horizontal"
) +
guides(
fill = guide_legend(ncol = 3),
)
legend <- cowplot::get_legend(p)
plot(legend)
# legend here.
p <- ggplot(species, aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
geom_jitter() +
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = dark8, drop = FALSE) +
scale_color_manual(values = dark8, drop = FALSE) +
theme_minimal() +
labs(x = NULL, y = NULL) +
theme(
plot.title = element_text(hjust = 0.5),
legend.title = element_text(hjust = 0.5, position = 'top'),
legend.direction ="horizontal"
) +
guides(
fill = guide_legend(ncol = 3),
)
legend <- cowplot::get_legend(p)
plot(legend)
# legend here.
p <- ggplot(species, aes(fill = taxon, color = taxon, shape = taxon, x = x, y = y), size = 2) +
geom_jitter() +
scale_shape_manual(values = shapes, drop = FALSE) +
scale_fill_manual(values = dark8, drop = FALSE) +
scale_color_manual(values = dark8, drop = FALSE) +
theme_minimal() +
labs(x = NULL, y = NULL) +
theme(
plot.title = element_text(hjust = 0.5),
legend.title = element_text(hjust = 0.5),
legend.direction ="horizontal"
) +
guides(
fill = guide_legend(ncol = 3),
)
legend <- cowplot::get_legend(p)
plot(legend)
unique(as.character(unique(species$taxon)))
unique(as.character(unique(species$taxon)))
##### calculate the beta-diversity comparisions between the sites ##
spp_by_site <- bind_rows(
cbind(site_a, Site = 'A'), cbind(site_b, Site = 'B'), cbind(site_c, Site = 'C')
) %>%
distinct(Site, taxon) %>%
mutate(Values = 1) %>%
pivot_wider(names_from = taxon, values_from = Values) %>%
column_to_rownames('Site')
spp_by_site <- apply(spp_by_site, MARGIN = 2, FUN = function(x){ifelse(is.na(x), 0, 1)})
rm(dark8, shapes)
beta_d_results <- vegan::betadiver(spp_by_site, 'w')
beta_distances <- data.frame(
row.names = c('B', 'C'),
A = c(0.777, 0.4),
B = c('', 0.2727)
)
beta_d_tab <- gridExtra::tableGrob(beta_distances)
plot(beta_d_tab)
plot_grid(plot_row, legend, rel_widths = c(1, 0.4))
plot_grid(plot_row, legend, ncol = 1, rel_heights = c(1, 0.4))
plot_grid(plot_row, legend, ncol = 1, rel_heights = c(1, 0.25))
plot_grid(plot_row, legend, ncol = 1, rel_heights = c(1, 0.2))
plot_row <- plot_grid(plot_a, plot_b, plot_c, ncol = 3)s
plot_row <- plot_grid(plot_row, legend, ncol = 1, rel_heights = c(1, 0.2))
title <- ggdraw() +  # create a shared title for the plot with three Sites.
draw_label(
paste0(
"\u03b3-Diversity (",
length(unique(spp_by_site$taxon)) ,
") of an area with three major sites"),
fontface = 'bold',
x = 0,
hjust = 0
) +
theme( # add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 7)
)
plot_grid(
title, plot_row,
ncol = 1,
rel_heights = c(0.1, 1)
)
title <- ggdraw() +  # create a shared title for the plot with three Sites.
draw_label(
paste0(
"\u03b3-diversity (",
length(unique(spp_by_site$taxon)) ,
") of an area with three major sites"),
fontface = 'bold',
x = 0,
hjust = 0
) +
theme( # add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 7)
)
diversity_plot ,- plot_grid(
rm(dark8, shapes, plot_a, plot_b, plot_c)
diversity_plot <- plot_grid(
title, plot_row,
ncol = 1,
rel_heights = c(0.1, 1)
)
plot_grid(
diversity_plot, beta_d_tab,
ncol = 1,
rel_widths = c(0.1, 1)
)
plot_grid(
diversity_plot, beta_d_tab,
ncol = 2,
rel_widths = c(0.1, 1)
)
plot_grid(
diversity_plot, beta_d_tab,
ncol = 2,
rel_widths = c(1, 0.1)
)
plot_grid(
diversity_plot, beta_d_tab,
ncol = 2,
rel_widths = c(1, 0.2)
)
plot_grid(
diversity_plot, beta_d_tab,
ncol = 2,
rel_widths = c(1, 0.4)
)
plot_grid(
diversity_plot, beta_d_tab,
ncol = 2,
rel_widths = c(1, 0.35)
)
##########
?tableGrob
